<div class="row">

  <div class="col-3 admin-vertical-nav">
    <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
      <a class="nav-link active" id="v-pills-home-tab" data-toggle="pill" href="#v-pills-home" role="tab" aria-controls="v-pills-home" aria-selected="true">Users</a>
    </div>
  </div>

  <div class="col-10">
    <div class="container">

      <div class="jumbotron my-5">
        <div class="row">
          <h2>Manage Users</h2>
          <button type="button" class="add-user-btn btn btn-success" (click)="open(newUserModal)">Add User</button>
        </div>

        <div class="table-wrapper">
            <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-hover table-bordered">
              <thead>
                <tr>
                  <th scope="col">Username</th>
                  <th scope="col">Name</th>
                  <th scope="col">Roles</th>
                  <th scope="col">Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr class="table-active" *ngFor="let user of allUsers">
                  <td>{{user.userName}}</td>
                  <td>{{user.firstName + " " + user.lastName}}</td>
                  <td>{{user.roles}}</td>
                  <td class="actions"><fa-icon class="icon" [icon]="faTrashAlt" title="Delete User"></fa-icon><fa-icon class="icon" [icon]="faPencilAlt" title="Edit User"></fa-icon></td>
                </tr>
              </tbody>
            </table>
          </div>
        
      </div>
     
  </div>
</div>

<ng-template #newUserModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Add User</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>

  <form #newUserForm="ngForm" (ngSubmit)="registerNewUser(newUserForm); resetNewUserForm(newUserForm); modal.close('Save click')">
    <div class="modal-body">

      <div class="form-group">
        <label for="username">Username</label>
        <input type="username" class="form-control" id="username" placeholder="Enter Username" name="Username" #Username="ngModel" [(ngModel)]="newUser.Username" minlength="3" required>
        <small id="usernameHelp" class="form-text text-muted">Remember this. This is what the user will use to log in.</small>
      </div>

      <div class="form-group">
          <label for="roles">Roles</label>
          <ng-select
              [items]="allUserRoles"
              [multiple]="true"
              [closeOnSelect]="false"
              [searchable]="false"
              bindLabel="roles"
              placeholder="Select Roles"
              name="Roles" 
              #Roles="ngModel"
              [(ngModel)]="newUser.Roles">
          </ng-select>
          <small id="usernameHelp" class="form-text text-muted">Roles determine what permissions this user will have.</small>
      </div>

      <div class="form-group">
          <label for="password">Password</label>
          <input type="password" class="form-control" id="password" placeholder="Enter Password" name="Password" #Password="ngModel" [(ngModel)]="newUser.Password" required>
          <small id="passwordHelp1" class="form-text text-muted">Must be at least 5 characters long and contain 1 numerical. Remember this!</small>
        </div>

      <div class="form-group">
        <label for="firstName">First Name</label>
        <input type="firstName" class="form-control" id="firstName" placeholder="Enter First Name" name="FirstName" #FirstName="ngModel" [(ngModel)]="newUser.FirstName" required>
      </div>

      <div class="form-group">
          <label for="lastName">Last Name</label>
          <input type="lastName" class="form-control" id="lastName" placeholder="Enter First Name" name="LastName" #LastName="ngModel" [(ngModel)]="newUser.LastName" required>
      </div>

      <div class="form-group">
          <label for="email">Email</label>
          <input type="email" class="form-control" id="email" placeholder="Enter Email" name="Email" #LastName="ngModel" [(ngModel)]="newUser.Email" required>
      </div>

  </div>

  <div class="modal-footer">
    <button type="button" type="submit" class="btn btn-success create-user-btn" [disabled]=newUserForm.invalid>Create User</button>
  </div>

</form>

</ng-template>